var _t=Object.defineProperty;var A=(n,e)=>{for(var t in e)_t(n,t,{get:e[t],enumerable:!0})};var ye={};A(ye,{__children:()=>It});var J={};A(J,{__children:()=>xt,__onconnected:()=>gt});function gt(){this.header!==void 0&&(this.__children.header.__element.innerText=this.header),this.text!==void 0&&(this.__children.text.__element.innerHTML=this.text)}var xt={header:{__element:"h3",__attributes:{innerText:"Header"}},text:{__element:"p",__attributes:{innerHTML:"This is the text."}}};var G={};A(G,{__attributes:()=>vt,__children:()=>Pt,__onconnected:()=>St});function St(){["number","title","description"].forEach(e=>{this[e]!==void 0&&(this.__children.container.__children[e].__element.innerText=this[e])}),this.projects!==void 0&&this.projects.forEach(e=>{let t=document.createElement("li"),o=document.createElement("a");e.active===!1?(t.style.opacity="0.5",t.style.pointerEvents="none",t.style.userSelect="none"):(e.oncreate&&e.oncreate(t),e.onclick?o.onclick=e.onclick:e.href&&(o.href=e.href)),t.appendChild(o),o.innerText=e.name,this.__children.container.__children.projects.__element.appendChild(t)})}var vt={style:{padding:"1rem"}},Pt={container:{__children:{number:{__element:"p",__attributes:{innerText:"",style:{fontSize:"0.9rem",paddingBottom:"0.5rem",margin:"0px"}}},title:{__element:"h3",__attributes:{innerText:"Feature"}},description:{__element:"p",__attributes:{innerText:"This is a feature that is featured."}},projects:{__element:"ul",__children:{}}}}};var me={};A(me,{__element:()=>jt,__onconnected:()=>Ct,channel:()=>wt,height:()=>Ot,width:()=>Et});var wt="brainsatplay",Et="100%",Ot=480,jt="div",Ct=function(){let n=document.createElement("script");n.src="https://embed.twitch.tv/embed/v1.js",document.body.appendChild(n),n.onload=()=>{new Twitch.Embed(this.__element,{width:this.width,height:this.height,channel:this.channel})}};var Fe={borderBottom:"2px solid white",paddingBottom:"0.5rem",paddingRight:"1rem"},Ke={list:[],__element:"ul",__onconnected:function(){this.__element.innerHTML="",this.list.forEach(n=>{let e=document.createElement("li"),t=document.createElement("a");t.innerText=n.label,e.appendChild(t),this.__element.appendChild(e),n.oncreate&&n.oncreate(e),n.onclick?t.onclick=n.onclick:t.href=n.href})}},Me=[{label:"Home",href:""},{label:"About",href:"#about"},{label:"Work",href:"#work"},{label:"Ethos",href:"#ethos"},{label:"Twitch",href:"#twitch"}],It={nav:{__element:"nav",__attributes:{style:{position:"fixed",top:"0px",right:"0px",paddingRight:"2rem"}},__children:{list:{list:Me,__compose:Ke,__attributes:{style:{textTransform:"uppercase"}}}}},content:{__children:{hero:{__element:"section",__children:{container:{__children:{title:{__element:"h1",__attributes:{innerText:"Brains@Play"}},subtitle:{__element:"h2",__attributes:{innerText:"The Universal Web Development Cooperative"}},description:{__element:"p",__attributes:{innerText:"We empower everyone to build better apps\u2014together."}}}}}},about:{__element:"section",__attributes:{style:{background:"darkslategray"}},__children:{container:{__children:{title:{__children:{text:{__element:"h2",__attributes:{innerText:"Who We Are"}},support:{__element:"a",__attributes:{href:"https://opencollective.com/brainsatplay",target:"_blank"},__children:{image:{__element:"img",__attributes:{height:40,src:"https://opencollective.com/brainsatplay/contribute/button@2x.png?color=white"}}}}},__attributes:{style:{display:"flex",justifyContent:"space-between",alignItems:"center",...Fe}}},description:{__element:"p",__attributes:{innerHTML:"We're currently a group of two developers\u2014<a href='https://github.com/garrettmflynn' target='_blank'>Garrett Flynn</a> and <a href='https://github.com/garrettmflynn' target='_blank'>Joshua Brewster</a>\u2014working to build a better Web with free software."}},statements:{__attributes:{style:{display:"flex",flexWrap:"wrap"}},__children:{mission:{header:"Mission",text:"Make code universally <a>shareable</a>, <a>modifiable</a>, and <a>usable</a>.",__compose:J,__attributes:{style:{flexBasis:"50%",padding:"15px"}}},vision:{header:"Vision",text:"Engulf the Web in public experiments of communal organization and citizen science, engineering, and art.",__compose:J,__attributes:{style:{flexBasis:"50%",padding:"15px"}}}}}}}}},ethos:{__element:"section",__children:{container:{__children:{title:{__element:"h2",__attributes:{innerText:"Our Ethos",style:{...Fe}}},featureone:{number:"1",title:"Recompose the Web",description:"We are consuming the infrastructure of the Web.",projects:[{name:"ES Components (ESC)",link:"https://github.com/brainsatplay/escomponent",description:"A specification for composable JavaScript objects with concurrent message-passing."},{name:"ESCode",link:"https://github.com/brainsatplay/escode",description:"A framework for using ES Components using graphscript."},{name:"Web Source Accessibility Guidelines (WSAG)",active:!1,description:"Identify best practices to allow anyone to use, modify, and share Web Components."}],__compose:G},featuretwo:{number:"2",title:"Make Software Yours",description:"Bring yourself to every page.",projects:[{name:"Browser Extension",link:"https://github.com/brainsatplay/brainsatplay-extension",oncreate:n=>{let e="brainsatplay-injection-proxy",t=s=>{window.postMessage({source:s,command:"openOptions"})},o=()=>{let s=!1;n.onclick=()=>{let r="https://github.com/brainsatplay/brainsatplay-extension";window.open(r,"_blank")};let i=document.getElementById(e);if(i&&i.getAttribute("data-version")){let a=i.getAttribute("data-id");s=!0,n.onclick=()=>t(a)}return s};window.onload=function(){o()||setTimeout(o,100)}},description:"Apply components across web pages."},{name:"Desktop App",link:"https://github.com/brainsatplay/brainsatplay-electron",onclick:()=>{customProtocolCheck("brainsatplay://",()=>{window.open("https://github.com/brainsatplay/brainsatplay-desktop","_blank"),console.log("Custom protocol not found.")},()=>{console.log("Custom protocol found and opened the file successfully.")})},description:"Create composable cross-platform web systems."}],__compose:G},featurethree:{number:"3",title:"Free Public Experimentation",description:"We are supporting new scientific and human-computer interaction (HCI) advances that drive experimentation on the Web and translate quickly across sites.",projects:[{name:"WebNWB",link:"https://github.com/brainsatplay/webnwb",description:"Enable citizen neuroscience."},{name:"MyAlyce",link:"https://myalyce.com",description:"Enable citizen neuroscience."}],__compose:G}}}}},twitch:me}},footer:{__element:"footer",__attributes:{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",backgroundColor:"black",color:"white",padding:"25px 50px"}},__children:{title:{__children:{text:{__element:"span",__attributes:{innerText:"\xA9 Brains@Play 2022"}}}},links:{__compose:Ke,list:[{label:"Home",href:"/"},...Me]},social:{__element:"ul",__children:{email:{__element:"li",__children:{link:{__element:"a",__attributes:{href:"mailto:contact@brainsatplay.com",innerText:"contact@brainsatplay.com"}}}},newsletter:{__element:"li",__children:{link:{__element:"a",__attributes:{href:"https://brainsatplay.substack.com",innerText:"Sign up for our newsletter",style:{fontSize:"0.8rem"}}}}}}}}}};var be={};A(be,{__children:()=>kt});var kt={hero:{__element:"section",__children:{container:{__children:{title:{__element:"h1",__attributes:{innerText:"The Universal Web Development Cooperative"}},subtitle:{__element:"h2",__attributes:{innerText:"It all began with a dream of agency for every brain."}},description:{__element:"p",__attributes:{innerText:"We started working in 2021 and never stopped."}}}}}}};var _e={};A(_e,{__children:()=>Tt});var Tt={hero:{__element:"section",__children:{container:{__children:{title:{__element:"h1",__attributes:{innerText:"Our Work"}},subtitle:{__element:"h2",__attributes:{innerText:"The Universal Web Development Cooperative"}}}}}}};var At="[object Module]",L=n=>!!(n&&(!!Object.keys(n).reduce((t,o)=>{let s=Object.getOwnPropertyDescriptor(n,o),i=s&&s.get&&!s.set?1:0;return t+i},0)||Object.prototype.toString.call(n)===At));var Re=(n,e)=>{if(n&&typeof n=="object"&&e&&typeof e=="object"){let t=JSON.stringify(n),o=JSON.stringify(e);return t===o}else return n===e},F=(n,e)=>Promise.all(Object.getOwnPropertySymbols(n).map(t=>e(t,n[t]))),E=(n,e)=>{let t=e.path[n];if(!t)throw new Error("Invalid Path Type");return t.filter(s=>typeof s=="string").join(e.keySeparator)},V=(n,e)=>{let t=n;return typeof n=="string"?t=n.split(e.keySeparator):typeof n=="symbol"&&(t=[n]),{id:t[0],path:t.slice(1)}},k=(n,e,t,o,s=!0)=>{if(n instanceof Function&&(o&&typeof o=="object"&&typeof o.then=="function"?o.then(i=>n(e,t,i)):n(e,t,o)),s&&globalThis.ESMonitorState){let i=globalThis.ESMonitorState.callback;globalThis.ESMonitorState.state[e]={output:o,value:t},k(i,e,t,o,!1)}};var Lt=60,B=class{constructor(e,t){this.listeners={};this.setOptions=(e={})=>{for(let t in e)this[t]=e[t]};this.add=e=>{let t=e.sub;return this.listeners[t]=e,this.start(),!0};this.get=e=>this.listeners[e];this.remove=e=>{delete this.listeners[e],Object.keys(this.listeners).length||this.stop()};this.poll=e=>{F(e,(t,o)=>{let{callback:s,current:i,history:r}=o;o.path.resolved||(o.path.resolved=E("output",o)),Re(i,r)||(k(s,o.path.resolved,{},i),typeof i=="object"?Array.isArray(i)?r=[...i]:r={...i}:e[t].history=i)})};this.start=(e=this.listeners)=>{this.sps?this.#e||(console.warn("[escode]: Starting Polling!"),this.#e=setInterval(()=>this.poll(e),1e3/this.sps)):this.sps=Lt};this.stop=()=>{this.#e&&(console.warn("[escode]: Stopped Polling!"),clearInterval(this.#e),this.#e=void 0)};e&&(this.listeners=e),t&&(this.sps=t)}#e;#t;get sps(){return this.#t}set sps(e){this.#t=e;let t=this.listeners;Object.keys(t).length&&(this.stop(),this.start())}};var N={};A(N,{functionExecution:()=>te,functions:()=>qe,getProxyFunction:()=>we,info:()=>oe,register:()=>He,set:()=>Se,setterExecution:()=>ee,setters:()=>Pe});globalThis.ESMonitorState={state:{},callback:void 0,info:{}};var We=globalThis.ESMonitorState;var Ft=async(n,e)=>{let t=globalThis.performance.now(),o=await n(...e),s=globalThis.performance.now();return{output:o,value:s-t}},Ge={performance:Ft},Be=(n,e,t)=>{let o={value:{},output:void 0},s={...We.info,...t};for(let i in s)if(s[i]&&Ge[i]){let r=n;n=async(...a)=>{let p=await Ge[i](r,a);return o.value[i]=p.value,p.output}}return o.output=n(...e),o};var O=Symbol("isProxy"),M=Symbol("fromInspectable"),yn=Symbol("fromInspectableHandler");var j=".",Mt="default",ge="__esmpileSourceBundle",Ne=n=>!1,l={isGraphScript:"__",default:Mt,start:"__onconnected",stop:"__ondisconnected",connected:"__connected",resolved:"__resolved",started:"__started",hierarchy:"__children",element:"__element",webcomponents:"__define",attributes:"__attributes",listeners:{value:"__listeners",branch:"__branch",bind:"__bind",trigger:"__trigger",format:"__format"},trigger:"__trigger",compose:"__compose",apply:"__apply",uri:"src",reference:"ref",childPosition:"__childposition",attribute:"escomponent",options:"__options",parent:"__parent",component:"__component",source:"__source",path:"__path",animate:"__animate",states:"__states",promise:"__childresolved",editor:"__editor",flow:"__manager",original:"__original",resize:"__onresize",proxy:"__proxy"};var Y=(n,e)=>n in e,$t=(n,e,t)=>{let o=e[n[0]];if(o){let s=o[n.slice(1).join(t)];if(s)return s}},Z=(n,e,t={})=>{let o=t.fallbacks??[],s=t.keySeparator??j;if(t.shortcuts){let a=$t(e,t.shortcuts,s);if(a)return t.output==="info"?{value:a,exists:!0,shortcut:!0}:a}typeof e=="string"?e=e.split(s).flat():typeof e=="symbol"&&(e=[e]);let i;e=[...e],e=e.map(a=>typeof a=="string"?a.split(s):a).flat();let r=n;for(let a=0;a<e.length;a++)if(r){let p=e[a];if(!Y(p,r)&&"__children"in r)for(let c in o){let f=o[c];if(Y(f,r)){r=r[f];break}}i=Y(p,r),i?r=r[p]:(r=void 0,i=!0)}return t.output==="info"?{value:r,exists:i}:r},Q=(n,e,t,o={})=>{let s=o?.create??!1,i=o?.keySeparator??j;typeof n=="string"?n=n.split(i):typeof n=="symbol"&&(n=[n]),n=[...n];let r=[...n],a=r.pop();t.__children&&(t=t.__children);for(let p=0;p<r.length;p++){let c=r[p],f=Y(c,t);s&&!f&&(t[c]={},f=!0),f&&(t=t[c]),t.__children&&(t=t.__children)}return t[a]=e,!0};var xe={};A(xe,{functions:()=>zt,objects:()=>Wt});function Rt(n,e){let t=this,o=this.target;if(!this.parent){let s=o[n];if(typeof s=="function")o[n]=async(...i)=>await this.proxy[n]({[M]:!0,value:s},...i);else try{Object.defineProperty(o,n,{get:()=>s,set:function(i){s=i,t.proxy[n]={[O]:this[O],[M]:!0,value:i}},enumerable:!0,configurable:!0})}catch{console.error(`Could not reassign ${n} to a top-level setter...`)}}e&&this.newKeys.add(n),this.create(n,o,void 0,!0)}var X=Rt;var zt=function(){let n=this;return{apply:async function(e,t,o){try{let s=e;o[0]?.[M]&&(s=o[0].value,o=o.slice(1));let r=n.listeners.functions,a=n.path.join(n.options.keySeparator),p=r?r[a]:void 0,c,f={};p?(f=te(t,p,s,o),c=f.output):(c=s.apply(t,o),f=n?.state?.[a]?.value??{});let u=n.options.callback;return k(u,a,f,c),c}catch(s){console.warn("Function failed:",s,n.path)}}}},Wt=function(){let n=this;return{get(e,t,o){return t===O?!0:Reflect.get(e,t,o)},set(e,t,o,s){if(t===O)return!0;let i=[...n.path,t].join(n.options.keySeparator),r=o?.[O],a=o?.[M];a&&(o=o.value);let p=n.listeners.setters,c=Object.getOwnPropertyDescriptor(e,t);if(c&&!c.get&&!c.set&&typeof n.options.globalCallback=="function"){let y=n.path[0];X.call(n,t,!0),Se("setters",i,o,n.options.globalCallback,{[y]:n.root},n.listeners,n.options)}if(o){let y=n.create(t,e,o);y&&(o=y)}let u=!r;if(p&&u&&!n.newKeys.has(t)){let y=p[i];y&&ee(y,o)}let d=n.options.callback,m=n?.state?.[i]?.value??{};return k(d,i,m,o),a||!u?!0:Reflect.set(e,t,o,s)}}};var Gt=(n,e,t)=>{try{t===void 0&&(t=n[e])}catch(c){return c}if(n[e]&&n[e][O])return!1;let s=typeof t,i=s==="object",r=s=="function";if(!t||!(i||r)||t instanceof Element||t instanceof EventTarget)return!1;let p=i&&L(t);if(r)return!0;{let c=Object.getOwnPropertyDescriptor(n,e);if(c&&(c.value&&c.writable||c.set)){if(!p)return!0}else if(!n.hasOwnProperty(e))return!0}return!1},K=class{constructor(e={},t={},o,s){this.path=[];this.listeners={};this.newKeys=new Set;this.state={};this.set=(e,t,o)=>{this.state[e]={output:o,value:t},Q(e,o,this.proxy,{create:!0})};this.check=Gt;this.create=(e,t,o,s=!1)=>{let i=this.check(t,e,o);if(o===void 0&&(o=t[e]),i&&!(i instanceof Error))return t[e]=new K(o,this.options,e,this),t[e];if(s)try{this.proxy[e]=o??t[e]}catch(r){let a=L(t),p=[...this.path,e];console.error(`Could not set value (${p.join(this.options.keySeparator)})${a?" because the parent is an ESM.":""}`,a?"":r)}};if(t.pathFormat||(t.pathFormat="relative"),t.keySeparator||(t.keySeparator=j),e.__proxy)this.proxy=e.__proxy;else if(e[O])this.proxy=e;else{this.target=e,this.options=t,this.parent=s,this.parent?(this.root=this.parent.root,this.path=[...this.parent.path],this.state=this.parent.state??{}):this.root=e,o&&this.path.push(o),this.options.listeners&&(this.listeners=this.options.listeners),this.options.path&&(this.options.path instanceof Function?this.path=this.options.path(this.path):Array.isArray(this.options.path)?this.path=this.options.path:console.log("Invalid path",this.options.path)),this.path&&(this.path=this.path.filter(a=>typeof a=="string")),this.options.keySeparator||(this.options.keySeparator=j);let i=this.options.type;i!="object"&&(i=typeof e=="function"?"function":"object");let r=xe[`${i}s`].call(this);this.proxy=new Proxy(e,r),Object.defineProperty(e,"__proxy",{value:this.proxy,enumerable:!1}),Object.defineProperty(e,"__esInspectable",{value:this,enumerable:!1});for(let a in e)X.call(this,a)}return this.proxy}};var ne=(n,e,t,o)=>{let s=o.reference,i=Array.isArray(n)?n[0]:typeof n=="string"?n.split(t.keySeparator)[0]:n,r=o.hasOwnProperty("static")?!o.static:!1;r&&!globalThis.Proxy&&(r=!1,console.warn("Falling back to using function interception and setters...")),r&&(e=new K(e,{pathFormat:t.pathFormat,keySeparator:t.keySeparator,listeners:o.listeners,path:p=>p.filter(c=>!t.fallbacks||!t.fallbacks.includes(c))},i));let a={keySeparator:t.keySeparator,...o};return Q(n,e,s,a),e};var oe=(n,e,t,o,s,i,r,a={})=>{typeof t=="string"&&(t=t.split(r.keySeparator));let p=t.join(r.keySeparator),c=s,f=a.ref,u=a.path,d=x=>Z(f??s,x,{keySeparator:r.keySeparator,fallbacks:r.fallbacks}),m=(x,v)=>{ne(x,v,r,{reference:f??s,listeners:i})},y=r.onUpdate,S={};y&&typeof y=="object"&&y.callback instanceof Function&&(S=y.info??{},y=y.callback);let g=[n,...t],h={absolute:g,relative:p.split(r.keySeparator),parent:g.slice(0,-1)};h.output=h[r.pathFormat];let _={id:n,path:h,keySeparator:r.keySeparator,infoToOutput:S,callback:(...x)=>{let v=e(...x);return y instanceof Function&&y(...x),v},get current(){return d(u??_.path.absolute)},set current(x){m(u??_.path.absolute,x)},get parent(){return d(u?u?.slice(0,-1):_.path.parent)},get reference(){return c[n]},set reference(x){c[n]=x},original:o,history:typeof o=="object"?Object.assign({},o):o,sub:Symbol("subscription"),last:t.slice(-1)[0]};return _},Ue=(n,e,t)=>{if(t){let o=Math.random();t.symbol[e]={name:n,id:o},t.name[n]||(t.name[n]={}),t.name[n][o]=e}},He=(n,e,t)=>{let o=E("absolute",n);return e[o]||(e[o]={}),e[o][n.sub]=n,Ue(o,n.sub,t),!0},ve={functions:qe,setters:Pe},Se=(n,e,t,o,s,i,r)=>{let{id:a,path:p}=V(e,r),c=oe(a,o,p,t,s,ve,r);if(ve[n])ve[n](c,i[n],i.lookup);else{let f=E("absolute",c);i[n][f][c.sub]=c,i.lookup&&Ue(f,c.sub,i.lookup)}},Bt=(n,e)=>e[E("absolute",n)],De=(n,e,t,o)=>{let s=!!Bt(n,e);if(!s){let i=n.parent,r=i?.[n.last];s=t(r,i)}return He(n,e,o)},ee=(n,e)=>F(n,(t,o)=>{let s=E("output",o);k(o.callback,s,{},e)});function Pe(n,e,t){let o=this;return De(n,e.setters,(s,i)=>{let r=s;if(!!i&&!i[O]){let a=!0;try{delete i[n.last]}catch{console.error("Unable to redeclare setters. May already be a dynamic object..."),a=!1}if(a)try{Object.defineProperty(i,n.last,{get:()=>r,set:async p=>{let c=typeof r=="function";if(r=p,c)r=we.call(o,n,e,r);else{let f=Object.assign({},e.setters[E("absolute",n)]);ee(f,p)}},enumerable:!0,configurable:!0})}catch(p){throw p}}},t)}function we(n,e,t){return function(...o){let s=e.functions[E("absolute",n)];return te(this,s,t??n.original,o)}}var te=(n,e,t,o)=>{e=Object.assign({},e);let s=Object.getOwnPropertySymbols(e),i=e[s[0]]??{},r=Be((...a)=>t.call(n,...a),o,i.infoToOutput);return F(e,(a,p)=>{let c=E("output",p);k(p.callback,c,r.value,r.output)}),r};function qe(n,e,t){return De(n,e.functions,(o,s)=>{if(!s[O])return s[n.last]=we.call(this,n,e),Pe(n,e,t)},t)}var se=(n,e,t)=>{let o=t.accumulator;o||(o=t.accumulator={});let s=t.ignore||[],i=t.path||[],r=t.condition||!0,a=[],p=[],c=(f,u={},d)=>{for(let m in f){if(s.includes(m))continue;let y=f[m],S=[...d.path,m],g={typeof:typeof y,name:y?.constructor?.name,simple:!0,object:y&&typeof y=="object",path:S};if(g.object){let h=g.name;if(L(y)||h==="Object"||h==="Array"){g.simple=!0;let _=a.indexOf(y);if(_!==-1)u[m]=p[_];else{a.push(y);let x=r instanceof Function?r(m,y,g):r;g.pass=x,u[m]=e(m,y,g),x&&(p.push(u[m]),u[m]=c(y,u[m],{...d,path:S}))}}else g.simple=!1,u[m]=e(m,y,g)}else u[m]=e(m,y,g)}return u};return c(n,o,{path:i})};var Je=()=>({symbol:{},name:{}}),U=class{constructor(e={}){this.poller=new B;this.options={pathFormat:"relative",keySeparator:j};this.listeners={polling:this.poller.listeners,functions:{},setters:{},lookup:Je()};this.references={};this.get=(e,t,o=this.references,s=!0)=>Z(o,e,{keySeparator:this.options.keySeparator,fallbacks:this.options.fallbacks,output:t},s);this.set=(e,t,o={})=>{let s={...o};return s.reference||(s.reference=this.references),s.listeners||(s.listeners=this.listeners),ne(e,t,this.options,s)};this.on=(e,t)=>{let o=V(e,this.options);return this.listen(o.id,t,o.path)};this.getInfo=(e,t,o,s)=>{let i=oe(e,t,o,s,this.references,this.listeners,this.options),r=Math.random(),a=this.listeners.lookup,p=E("absolute",i);return a.symbol[i.sub]={name:p,id:r},a.name[p]||(a.name[p]={}),a.name[p][r]=i.sub,i};this.listen=(e,t,o=[],s={})=>{typeof o=="string"?o=o.split(this.options.keySeparator):typeof o=="symbol"&&(o=[o]);let i=o,r=this.get(e);if(!r){console.error("Reference does not exist.",e);return}s.poll||(s.poll=L(r)),s.seen||(s.seen=[]);let a=s,p=[e,...i],c=this.get(p),f=(S,g=!1)=>!(S&&typeof S=="object")||S instanceof Element?!1:g?!0:!Array.isArray(S),u={};f(c,!0)&&(c.__esInspectable&&(c.__esInspectable.options.globalCallback=t),se(c,(S,g,h)=>{if(!h.pass){let b=[...i,...h.path],_=this.listen(e,t,b,a);Object.assign(u,_)}},{condition:(S,g)=>f(g)}));let m,y=!1;try{if(m=this.getInfo(e,t,i,c),m)if(a.poll)y=this.poller.add(m);else{let S="setters";typeof c=="function"&&(S="functions"),y=this.add(S,m)}}catch(S){console.error("Fallback to polling:",o,S),y=this.poller.add(m)}if(y){if(u[E("absolute",m)]=m.sub,this.options.onInit instanceof Function){let S={};for(let g in m.infoToOutput)S[g]=void 0;this.options.onInit(E("output",m),S)}return u}else{console.error("Failed to subscribe to:",o);return}};this.add=(e,t)=>N[e]?N[e](t,this.listeners,this.listeners.lookup):(this.listeners[e][E("absolute",t)][t.sub]=t,!0);this.remove=e=>{e||(e={...this.listeners.functions,...this.listeners.setters,...this.listeners.polling}),typeof e!="object"&&(e={sub:e});for(let t in e){let o=e[t],s=i=>{this.unsubscribe(i)===!1&&console.warn(`Subscription for ${t} does not exist.`,i)};typeof o!="symbol"?F(o,s):s(o)}return!0};this.unsubscribe=e=>{let t=this.listeners.lookup.symbol[e],o=t.name,s=this.poller.get(e),i=this.listeners.functions[o],r=i?.[e],a=this.listeners.setters[o],p=a?.[e];if(s)this.poller.remove(e);else if(r)delete i[e],Object.getOwnPropertySymbols(i).length||(Object.defineProperty(r.parent,r.last,{value:r.original,writable:!0}),delete this.listeners.functions[o]);else if(p){if(delete a[e],!Object.getOwnPropertySymbols(a).length){let f=p.parent;if(f){let u=p.last,d=f[u];Object.defineProperty(f,u,{value:d,writable:!0})}delete this.listeners.setters[o]}}else return!1;delete this.listeners.lookup.symbol[e];let c=this.listeners.lookup.name[t.name];delete c[t.id],Object.getOwnPropertyNames(c).length||delete this.listeners.lookup.name[t.name]};Object.defineProperty(this.listeners,"lookup",{value:Je(),enumerable:!1,configurable:!1}),Object.assign(this.options,e),this.poller.setOptions(e.polling)}};var ie=U;var C=(n,e={})=>{if(typeof n=="object")Array.isArray(n)?(n=[...n],e.accumulator=[]):(n={...n},e.accumulator={});else return n;return se(n,(t,o,s)=>s.simple&&s.object?Array.isArray(o)?[]:{}:o,e),e.accumulator};var Ve=n=>typeof n=="object"&&typeof n.then=="function",w=(n,e)=>(typeof n=="object"&&Array.isArray(n)&&n.find(t=>Ve(t))&&(n=Promise.all(n)),Ve(n)?new Promise(t=>{n.then(async o=>{let s=e?e(o):o;t(s)})}):e?e(n):n),R=(n,e,t=[],o=!1,s=!1,i=!1,r=[])=>{let a=o?n:Object.assign({},n);if(s&&([a,e]=[e,a]),e){let p=Object.keys(a),c=new Set(Object.keys(e));p.forEach(f=>{c.delete(f);let u=[...t,f];if(typeof e[f]=="object"&&!Array.isArray(e[f]))if(typeof a[f]=="object"){let d=a[f],m=r.indexOf(d);m!==-1?a[f]=r[m]:(r.push(d),a[f]=R(d,e[f],u,o,!1,i,r))}else a[f]=e[f];else if(typeof e[f]=="function"){let d=a[f],m=typeof d=="function";m&&!d.functionList&&(d.functionList=[d]);let y=e[f],S=y.__compose===!0;if(!m||!i&&!S)a[f]=y;else if(d.functionList.includes(y))console.warn(`This function was already composed into ${u.join(".")}. Ignoring duplicate.`);else{let g=a[f]=function(...h){let b=d.call(this,...h);return y.call(this,...Array.isArray(b)?b:[b])};g.functionList||(g.functionList=[d]),g.functionList.push(e)}}else f in e&&(a[f]=e[f])}),c.forEach(f=>a[f]=e[f])}return a};var Ee="default",Oe="__operator",I={path:"__path",isGraphScript:"__",listeners:{value:"__listeners",branch:"__branch",bind:"__bind",trigger:"__trigger",format:"__format"}},je=Symbol("listenerObject"),Ye=Symbol("toSet"),H=Symbol("subscriptionKey"),Ze=Symbol("configKey"),Ce=Symbol("toResolveWithKey"),Ht=n=>I.listeners.format in n||I.listeners.branch in n||I.listeners.trigger in n||I.listeners.bind in n,Qe="INITIALIZED",Xe="REGISTERED",Dt={},qt={},Jt={},Ie=class{constructor(e,t,o){this.original={};this.active={};this.globals={};this.context={options:{}};this.rootPath="";this.status="";this.#e=[];this.#t=[];this.setInitialProperties=(e={},t,o={})=>{Object.assign(this.context,o),t&&(this.rootPath=t),this.context.options.keySeparator||(this.context.options.keySeparator=this.context.monitor.options.keySeparator),this.original=e,[{name:"active",ref:Jt},{name:"from",ref:Dt},{name:"to",ref:qt}].forEach(i=>{i.ref[this.context.id]||(i.ref[this.context.id]={}),this.globals[i.name]=i.ref[this.context.id]}),this.#o=this.getManager(),this.runEachListener(e,this.addToGlobalLog)};this.getManager=(e="from")=>{let t=e==="to"?this.globals.to:this.globals.from;return this.rootPath.split(this.context.options.keySeparator).forEach(o=>{t[o]||(t[o]={}),t=t[o]}),t[Ce]??this};this.onStart=e=>{let t=this.#o;t===this?this.status===Qe?e():this.#t.push(e):t.onStart(e)};this.runEachListener=(e,t)=>{if(!!t)for(let o in e){let s=e[o];if(!s){console.warn("Skipping empty listener:",o);continue}if(s&&typeof s=="object"){let i=s,r=o;for(let a in i)t(a,r,i[a])}else{let i=o,r=s,a=typeof r;a==="function"?t(i,"",r):a==="string"?t(i,r,r):console.error("Improperly Formatted Listener",r)}}};this.register=(e=this.original)=>{this.runEachListener(e,this.add),this.status=Xe};this.#i=e=>{let t=this.context.monitor.get(e.path,"info");if(typeof t.value=="function"){let o=Array.isArray(e.args)?e.args:[e.args];t.value(...o)}else console.error("Cannot yet trigger values...",e)};this.initialize=e=>{this.status?this.status===Xe?(this.status=Qe,this.#e.forEach(this.#i),this.#t.forEach(t=>t()),this.#t=[],this.#e=[]):this.#i(e):this.#e.push(e)};this.start=()=>{this.register(),this.initialize()};this.#s=e=>{let t=this.context.monitor.options.keySeparator;return!e||!this.rootPath||this.rootPath===e.slice(0,this.rootPath.length)&&e[this.rootPath.length]===t?e:[this.rootPath,e].join(t)};this.#n=e=>{let t={absolute:{},relative:{}};console.log("OG Path",e),e=this.#s(e),console.log("Got Path",e);let o=this.rootPath?e.replace(`${this.rootPath}.`,""):e,s=e.split(this.context.options.keySeparator);t.absolute.array=[this.context.id,...s],t.relative.array=o.split(this.context.options.keySeparator);let i=this.context.monitor.get(t.relative.array,void 0,this.context.instance,!1);if(this.context.graph){if(i&&this.context.bound)t.absolute.array=[this.context.id,this.context.bound,...t.absolute.array.slice(1)],t.relative.array.unshift(this.context.bound);else if(!i){let a=t.relative.array.join(this.context.options.keySeparator);i=this.context.graph.get(a)}}return i&&typeof i=="object"&&I.isGraphScript in i&&(i[Oe]?(t.absolute.array.push(Oe),t.relative.array.push(Oe)):i[Ee]&&(t.absolute.array.push(Ee),t.relative.array.push(Ee))),t.absolute.value=t.absolute.array.slice(1).join(this.context.options.keySeparator),t.relative.value=t.relative.array.join(this.context.options.keySeparator),t};this.add=(e,t,o=!0,s)=>{if(console.log("Adding",e,t,o,s),!o)return;let i=this.#n(e),r=this.#n(t),a=i.absolute.value;s||(s=this.globals.active[a]?.[H]),s||(s=this.context.monitor.on(i.absolute.array,(u,d,m)=>this.activate(u,m),{ref:this.context.instance,path:i.relative.array})),typeof o=="string"&&(o=r.absolute.array.slice(1).join(this.context.options.keySeparator));let p={value:o,[je]:!0};[this.active,this.globals.active].forEach(u=>{u[a]||(u[a]={});let d=u[a];d[H]||Object.defineProperty(d,H,{value:s,configurable:!0}),d[r.absolute.value]=p});let f=o[I.listeners.trigger];return f&&this.#o.initialize({path:i.absolute.array,args:f}),this.addToGlobalLog(a),p};this.addToGlobalLog=(e,t="from")=>{let o=this.#s(e),s=t==="to"?this.globals.to:this.globals.from;o.split(this.context.options.keySeparator).forEach(r=>{s[r]||(s[r]={}),s=s[r],s[Ce]||(s[Ce]=this)})};this.remove=(e,t)=>{let o=this.#n(e),s=this.#n(t),i=[o.absolute.value,s.absolute.value];[{ref:this.active,path:i},{ref:this.globals.active,path:i,unlisten:!0}].forEach(a=>{let{ref:p,path:c,unlisten:f}=a,u=p[c[0]];if(typeof u=="object"){if(delete u[c[1]],Object.keys(u).length===0){delete p[c[0]];let d=u[H];f&&d&&this.context.monitor.remove(d),delete u[H]}}else delete p[c[0]]})};this.clear=e=>{let t=this.#s(e);Object.keys(this.active).forEach(o=>{Object.keys(this.active[o]).forEach(s=>{(!t||o.slice(0,t.length)===t||s.slice(0,t.length)===t)&&this.remove(o,s)})})};this.has=(e,t=this.active)=>!!t[e];this.get=(e,t=this.active)=>t[e];this.activate=(e,t)=>{[{info:this.get(e,this.globals.active),name}].forEach(s=>{let i=s.info;if(i)if(i[je])this.pass(e,{value:i.value,parent:this.active,key:s.name,subscription:i.subscription,__value:!0},t);else if(typeof i=="object")for(let r in i)this.pass(e,{parent:i,key:r,subscription:i[r].subscription,value:i[r].value},t);else console.error("Improperly Formatted Listener",i)})};this.pass=(e,t,o)=>{let s=this.context.id,i=t?.__value,r=t.parent,a=t.key,p=t.parent[a];t=p.value;let c=p?.[Ze],f=t,u=typeof t,d=(g,h)=>{let b=this.context.monitor.get(g,"info");if(b.exists){let _=b.value,P={value:typeof _!="function"&&!_?.default?Ye:_};return h&&(t=P.value,r[a]=P),P}else return{value:void 0}},m=g=>{let h=[s];return h.push(...a.split(this.context.options.keySeparator)),d(h,g)},y=g=>{let h=[s],b=[];return this.rootPath&&b.push(...this.rootPath.split(this.context.options.keySeparator)),b.push(...g.split(this.context.options.keySeparator)),h.push(...b),h};if(typeof t=="boolean")i?console.error(`Cannot use a boolean for ${I.listeners.value}...`):m(!0);else if(u==="string"){let g=y(f);d(g,!0),i&&(r[a]={[f]:r[a]},a=f)}else t&&u==="object"&&Ht(f)&&("value"in f?i?t=r[a]=f.value:t=r[a].value=f.value:m(!0),f&&f&&(c=f),Object.defineProperty(r[a],Ze,{value:c}));let S=!0;if(c){let g=I.listeners.value;if(g in c){let h=y(c[g].original??c[g]);if(typeof c[g]=="string"){let b=this.context.monitor.get(h);b?c[g]={value:b,original:c[g]}:t=`because ${h.slice(1).join(this.context.options.keySeparator)} does not point correctly to an existing component.`}else c[g].value.__parent||(t=`because ${c[g].original??s.toString()} has become unparented.`)}else{let h=I.listeners.branch,b=I.listeners.format;if(h in c&&(c[h].find(x=>{let v=[];"if"in x&&v.push(x.if(o)),"is"in x&&v.push(x.is===o);let P=v.length>0&&v.reduce((z,W)=>z&&W,!0);return P&&"value"in x&&(o=x.value),P})||(S=!1)),b in c)try{o=c[b](o),o===void 0&&(S=!1)}catch(_){console.error("Failed to format arguments",_)}}}if(S&&o!==void 0){let g=Array.isArray(o)?o:[o];if(t===Ye){let h=[s];h.push(...a.split(this.context.options.keySeparator));let b=h.pop(),_=this.context.monitor.get(h,"info");_.value?_.value[b]=o:console.error(`Cannot set value on ${h.filter(x=>typeof x!="symbol").join(this.context.options.keySeparator)} from ${e}`)}else if(t?.default)t.default.call(t,...g);else if(typeof t=="function")r[a][je]?t.call(c?.[I.listeners.bind]?.value??this.context.instance,...g):t(...g);else{let h=a?`listener: ${e} \u2014> ${a}`:`listener from ${e}`;r?(console.warn(`Deleting ${h}`,t),delete r[a]):console.error(`Failed to add ${h}`,t)}}};(e||t||o)&&this.setInitialProperties(e,t,o)}#e;#t;#o;#i;#s;#n},et=Ie;var re=n=>typeof n=="string"&&(n.includes("/")||n.includes("."));var Vt=async(n,e)=>{let t=await fetch(n).then(o=>o.arrayBuffer());return WebAssembly.instantiate(t,e)},Yt=async(n,e)=>(e||(e={env:{abort:()=>console.log("Abort!")}}),WebAssembly.instantiateStreaming?await WebAssembly.instantiateStreaming(fetch(n),e):await Vt(n,e)),tt=Yt;var nt=(n,e)=>n[l.reference]?(console.warn("[escompose]: Falling back to ES Component reference...",e),n[l.reference]):Zt(e.message),ot=`Cannot transform ${l.compose} string without a compose utility function`;function ae(n,e){let t=typeof n=="string"?n:n[l.uri];if(t&&t.slice(-5)===".wasm"){let o=n.relativeTo??e?.relativeTo??window.location.href;o.slice(-1)[0]!=="/"&&(o+="/");let s=new URL(t,o).href;return new Promise(async i=>{let r=await tt(s,n.importOptions),a=Object.assign({},r.instance.exports);for(let p in a){let c=a[p];c instanceof WebAssembly.Memory?a[p]=new Uint8Array(c.buffer):c instanceof WebAssembly.Global&&Object.defineProperty(a,p,{get:()=>c.value,set:f=>c.value=f})}i(a)})}else if(t&&e.utilities){let o=e.utilities.bundle,s=o&&typeof o.function=="function",i=e.utilities.compile,r=i&&typeof i.function=="function";if(!s&&!r)n=nt(n,new Error(ot));else return new Promise(async a=>{try{if(s){let p=o.options??{};p.bundler||(p.bundler="datauri"),p.bundle||(p.collection="global"),p.relativeTo||(p.relativeTo=e.relativeTo??".");let c=o.function(t,p);await c.compile(),n=Object.assign({},c.result)}else if(r){let p=i.options??{};p.relativeTo||(p.relativeTo=e.relativeTo??"."),n=await i.function(n,p)}else throw new Error(ot)}catch(p){n=nt(n,p)}a(C(n))})}return C(n[l.reference]??n)}function Zt(n){return{[l.element]:"p",[l.hierarchy]:{b:{[l.element]:"b",[l.attributes]:{innerText:"Error: "}},span:{[l.element]:"span",[l.attributes]:{innerText:n}}}}}function Qt(n,e,t,o,s=!1){return n=R(n,e,t,s),n=st(n,n[l.compose],t,o,!0,s),w(n,i=>{let r=i[l.apply];return i=r&&(typeof r=="object"||re(r))?st(i,r,t,o,!1,s):i,w(i)})}var le=Qt;function st(n,e={},t=[],o={},s=!1,i=!1){Array.isArray(e)||(e=[e]);let r=w(e.map(a=>{let p=ae(a,o),c=(f,u=[],d=!0)=>{if(Array.isArray(f))f.forEach(m=>c(m,u),!0);else if(f[l.compose]){u.push(f);let m=f[l.compose];delete f[l.compose];let y=w(ae(m,o));c(y,u)}else d&&u.push(f);return u};return w(p,f=>c(f))}));return w(r,a=>{let p=a.flat(),c={};return p.forEach(f=>c=R(c,f,t,!1,!1)),R(n,c,t,i,s)})}var Xt=(n,e,t,o,s)=>{s=(s instanceof Element?s?.[n.component]:s)??e[n.parent];let i=s[n.isGraphScript],r={value:"",enumerable:!1,writable:!0};if(i&&typeof t=="string"){let a=s[n.path];a?r.value=[a,t]:r.value=[t],r.value=r.value.join(o.keySeparator)}Object.defineProperty(e,n.path,r)},ce=Xt;var fe={},it=document.createElement;document.createElement=function(n,e){let t=fe[n];return t&&!t.autonomous?it.call(this,t.tag,{is:n}):it.call(this,n,e)};var en={li:"LI",ol:"OL",ul:"UL",br:"BR",p:"Paragraph",textarea:"TextArea",a:"Anchor"},ke=!1,pe=(n,e)=>{if(fe[n.name])console.log("Already created component...");else{e=C(e);let t=ke?"":en[n.extends]??n.extends[0].toUpperCase()+n.extends.slice(1),o=new Function(`

        class ESComponentBase extends HTML${t}Element { 
            #properties;
            constructor(properties={}){
                super()
               this.#properties = properties
            }
        }
        return ESComponentBase;

        `)();class s extends o{constructor(p){super(p);e[l.element]=this,at(e)}connectedCallback(){let p=this[l.component],c=p[l.parent];p[l.parent]=c}disconnectedCallback(){console.log("Custom element removed from page.")}adoptedCallback(){console.log("Custom element moved to new page.")}attributeChangedCallback(p,c,f){console.log("Custom element attributes changed.",p,c,f)}}fe[n.name]={class:s,autonomous:ke,tag:n.extends};let i=fe[n.name].class;ke?customElements.define(n.name,i):customElements.define(n.name,i,{extends:n.extends})}};var tn=`__bound${l.editor}s`,nn=(n="svg",e)=>document.createElementNS("http://www.w3.org/2000/svg",n,e);function on(n){return n?Array.isArray(n)?!n.reduce((t,o)=>t*(ue(o)?0:1),!0):ue(n):!1}function ue(n){if(n.__element||on(n.__compose))return!0;if(n.__children)return sn(n.__children)}function sn(n){for(let e in n){let t=n[e];if(ue(t))return!0}}var lt=(n,e)=>n[0]==="svg"||e&&e.__element instanceof SVGElement?nn(...n):document.createElement(...n);function ct(n,e,t,o={},s){let i=o?.utilities,r=e[l.element],a=e[l.attributes],p;if(!(r instanceof Element)){let b=a&&Object.keys(a).length||ue(e)?"div":"link";r&&typeof r=="object"&&r.name&&r.extends&&(pe(r,e),e[l.element]=r=r.name),r===void 0?r=b:Array.isArray(r)?r=lt(r,t):typeof r=="object"&&(p=r,p.selectors?r=document.querySelector(p.selectors):p.id?r=document.getElementById(p.id):r=b),typeof r=="string"&&(r=lt([r],t));let x=Symbol("no input to the default function");e.hasOwnProperty("default")||(e.default=function(v=x){return v!==x&&(this[l.element].innerText=v),this[l.element]})}if(!(r instanceof Element))throw new Error("Element not created for "+n);let c=s||{};c.element=r,c.attributes=a,c.parentNode=e[l.parent]??(t?.[l.element]instanceof Element?t[l.element]:e[l.element].parentNode),c.onresize=e[l.resize],c.onresizeEventCallback=void 0;let f=c;typeof n!="string"&&(n=`${r.tagName??"element"}${Math.floor(Math.random()*1e15)}`),r.id||(r.id=n);let u,d;Object.defineProperty(e,`${l.connected}`,{value:new Promise(h=>u=async()=>{Object.defineProperty(e,`__${l.connected}`,{value:!0,writable:!1,enumerable:!1}),h(!0)}),writable:!1,enumerable:!1}),Object.defineProperty(e,`${l.resolved}`,{value:new Promise(h=>d=async()=>{h(!0)}),writable:!1,enumerable:!1}),Object.defineProperty(e,`__${l.connected}`,{value:u,writable:!0,enumerable:!1}),Object.defineProperty(e,`__${l.resolved}`,{value:d,writable:!1,enumerable:!1});let m=(h,b)=>h.slice(0,2)==="on"&&typeof b=="function",y=(h,b,_)=>!m(h,b)&&typeof b=="function"?b.call(_):b,S=h=>{if(e[l.element]instanceof Element)for(let b in h)if(b==="style")for(let _ in h.style)e[l.element].style[_]=y(b,h.style[_],e);else{let _=h[b];if(m(b,_)){let x=_;e[l.element][b]=(...v)=>{let P=e[l.proxy]??e;return x.call(P??e,...v)}}else{let x=y(b,_,e);e[l.element].setAttribute(b,x);try{e[l.element][b]=x}catch{}}}};Object.defineProperty(e,l.attributes,{get:()=>f.attributes,set:h=>{f.attributes=h,f.attributes&&S(f.attributes)}}),Object.defineProperty(e,l.element,{get:function(){if(f.element instanceof Element)return f.element},set:function(h){if(h instanceof Element){if(f.element!==h&&(f.element.insertAdjacentElement("afterend",h),f.element.remove()),f.element=h,e[l.path]!==void 0)for(let b in e[l.hierarchy]){let _=e[l.hierarchy][b];w(_,x=>{x[l.parent]=h})}S(f.attributes)}},enumerable:!0,configurable:!1}),Object.defineProperty(e,l.parent,{get:function(){let h=e[l.element].parentNode;return h&&h.hasAttribute(l.attribute)?e[l.element].parentNode[l.component]:{[l.element]:h}},set:h=>{if(typeof h=="string"){let _=document.querySelector(h);_?h=_:h=document.getElementById(h)}h?.__node?.ref&&(h=h.__node.ref),h?.[l.element]instanceof Element&&(h=h[l.element]);let b=e[l.element].parentNode;if(b!==h)if(e[l.element]instanceof Element){if(b&&e[l.element].remove(),h instanceof Element){let _=e[l.childPosition],x=h.children.length,v=e[l.element],P=e[`__${l.editor}`];P&&(v=P),_!==void 0&&_<x?h.children[_].insertAdjacentElement("beforebegin",v):h.appendChild(v),P&&P.setComponent(e)}}else console.error("No element was created for this Component...",e);if(h instanceof HTMLElement){ce(l,e,n,o,h);let _=h[l.component],x=e[`__${l.connected}`],v=x instanceof Function;e[`__${l.started}`]!==!0&&_?.[`__${l.started}`]===!0&&e[l.start](),v&&x()}},enumerable:!0});let g=e[l.resize];if(Object.defineProperty(e,l.resize,{get:function(){return g},set:function(h){f.onresize=h,f.onresizeEventCallback&&window.removeEventListener("resize",f.onresizeEventCallback),f.onresize&&(f.onresizeEventCallback=b=>{if(f.onresize&&e[l.element]instanceof Element){let _=e[l.proxy]??e;return h.call(_,b)}},window.addEventListener("resize",f.onresizeEventCallback))},enumerable:!0}),e[l.editor]){let h=e[l.editor],b=i.code?.class;if(b||(typeof h=="function"?b=h:console.error("Editor class not provided in options.utilities.code")),b){let _=i.code?.options??{};_=typeof h=="boolean"?_:{..._,...h};let x=_.bind,v=new b(_);if(v.start(),Object.defineProperty(e,`__${l.editor}`,{value:v}),x!==void 0){let P=e;x.split("/").forEach(W=>{if(W==="..")P=P[l.states].parentNode[l.component];else{if(W===".")return;P=P[l.hierarchy][W]}});let z=tn;P[z]?P[z].push(v):Object.defineProperty(P,z,{value:[v]})}}}return e[l.element][l.component]=e,e[l.element].setAttribute(l.attribute,""),e[l.element]=e[l.element],s||(e[l.resize]=f.onresize,f.parentNode&&(e.__parent=f.parentNode)),r}var D=(n,e,t)=>{Object.defineProperty(t,n,{value:e,writable:!1,configurable:!1,enumerable:!1})};var Te=(n,e,t,o=!0)=>{Object.defineProperty(n,`__${e.started}`,{value:t,writable:o,configurable:!1,enumerable:!1})};function ht(n,e,t){let o;return this[n.options].await?(o=pt.call(this,n,async()=>{t&&await t(),ut.call(this,n,e),Te(this,n,!0,!1)}),Te(this,n,o)):(pt.call(this,n,t),o=ut.call(this,n,e),Te(this,n,!0,!1)),o}async function pt(n,e){await this[n.connected],this[n.states].connected=!0;let t=`__bound${n.editor}s`,o=this[t];o&&o.forEach(s=>s.setComponent(this));for(let s in this[n.hierarchy]){let i=this[n.hierarchy][s],r=i[n.promise];r&&typeof r.then=="function"&&(i=this[n.hierarchy][s]=await r);let a=i[n.start];typeof a=="function"?await a():console.error(`Could not start component ${s} because it does not have a __onconnected function`)}return this[`__${n.resolved}`](),e&&await e(),this}function ut(n,e=[]){let t=`__${n.editor}`,o=this[n.parent]?.[t];o&&D(t,o,this);let s=this[ge];if(s){typeof s=="function"&&(s=this[n.source]=s()),delete this[ge];let r=this[n.path];this[t]&&this[t].addFile(r,s)}let i=this[n.proxy]??this;return this[n.states].initial.start&&this[n.states].initial.start.call(i),e.forEach(r=>r.call(this)),this}function dt(n){this[n.animate]&&typeof this[n.animate].stop=="function"&&this[n.animate].stop(),this[n.flow].clear();let e=this;for(;e[n.parent][n.path]!==void 0;){let i=e[n.element][n.parent];if(i)e=i,e&&e[n.flow]&&e[n.flow].clear(this[n.path]);else break}if(this[n.hierarchy])for(let i in this[n.hierarchy]){let r=this[n.hierarchy][i];typeof r[n.stop]=="function"?r[n.stop]():console.warn("Could not disconnect component because it does not have an __ondisconnected function",i,this.__children)}if(this[n.element]instanceof Element&&(this[n.element].remove(),this[n.remove])){let i=this[n.proxy]??this;this[n.remove].call(i)}let t=`${n.editor}Attached`;this[t]&&this[t].remove();let o=this[n.proxy]??this,s=this[n.states].initial.stop;return s&&s.call(o),this[n.start]=this[n.states].initial.start,this[n.stop]=s,this}var T={};function Ae(n){let e=n.animate??"animate";if(this[e]){let t=this[e],o=Math.random(),s=typeof t=="number"?t:"global";if(T[s])this.default(),T[s].objects[o]=this;else{let i=T[s]={objects:{[o]:this}},r=i.objects,a=()=>{for(let p in r)r[p].default()};if(s==="global"){let p=()=>{a(),i.id=window.requestAnimationFrame(p)};p(),T[s].stop=()=>{window.cancelAnimationFrame(i.id),i.cancel=!0}}else a(),i.id=setInterval(()=>a(),1e3/s),T[s].stop=()=>clearInterval(i.id)}this[e]={id:o,original:t,stop:()=>{delete T[s].objects[o],this[e]=t,Object.keys(T[s].objects).length===0&&(T[s].stop(),delete T[s])}}}}function an(n){return ht.call(this,n,[function(){Ae.call(this,n)}])}var mt=(n,e,t,o={})=>{let s=Symbol("isGraphScript");e[l.isGraphScript]=s;let i={connected:!1,initial:{start:e[l.start],stop:e[l.stop]}};D(l.states,i,e),D(l.options,o,e);let r=C(e),a=l.hierarchy;for(let u in e[a]){let d=e[a][u],m=d==null,y=m?JSON.stringify(d):typeof d;re(d)?e[a][u]={[l.apply]:d}:y!="object"&&(console.error(`Removing ${u} ${a} field, which is not an ES Component object. Got ${m?y:`a ${y}`} instead.`),delete e[a][u])}let p=e[l.webcomponents]??{};for(let u in p){let d=p[u],m=d[l.element];m.name&&m.extends&&pe(m,d)}let c=ct(n,e,t,o,i),f=i;e[l.element]=c,e[l.start]=()=>an.call(e,l),e[l.stop]=()=>dt.call(e,l);for(let u in e)if(!Ne(u)&&typeof e[u]=="function"){let d=Object.getOwnPropertyDescriptor(e,u);d&&d.get&&!d.set&&(e=Object.assign({},e));let m=e[u];e[u]=(...y)=>{let S=e[l.proxy]??e;return m.call(S,...y)}}return ce(l,e,o,n),Object.defineProperty(e,l.original,{value:r,enumerable:!1}),e[l.resize]=f.onresize,e[l.parent]=f.parentNode,e};function q(n,e,t={},o,s,i={},r={},a=!1){let p=o?.[l.path],c=p?[p,e]:typeof e=="string"?[e]:[];return n=le(n,t,c,i),w(n,f=>{let u=mt(e,f,o,i),d=c.join(i.keySeparator??j);s&&(s[e]=u),r[e]&&r[e](u),r.onInstanceCreated&&r.onInstanceCreated(d,u);let m=()=>{r.onInstanceReady&&r.onInstanceReady(d,u)};if(u[l.hierarchy]){let y=new Set,S=0,g=Object.entries(u[l.hierarchy]).map(async([b,_],x)=>{_=Object.assign({},_);let v=_[l.childPosition];if(v!==void 0)y.has(v)?console.warn(`[escompose]: Duplicate ${l.childPosition} value of ${v} found in ${b} of ${u[l.path]}`):y.add(v);else{for(;y.has(S);)S++;_[l.childPosition]=S,y.add(S)}let P=q(_,b,void 0,u,u[l.hierarchy],i,r,!0);return Object.defineProperty(u[l.hierarchy][b],l.promise,{value:P,writable:!1}),w(P)}),h=w(g,b=>(m(),b));if(a)return w(h,()=>u)}else m();return u})}var ko=new ie;var he=(n,e={},t={})=>{let o=typeof n;if(n instanceof NodeList&&(n=Array.from(n)),o==="string")n={[l.apply]:n};else if(n instanceof Element){let c=n[l.component];if(c){e=C(e);let f=e.__compose,u=e.__apply;delete e.__compose,delete e.__apply,f&&(console.warn("Cannot compose a component onto an element that already has a component. Merging with the base object instead..."),e=Object.assign(f,e)),u&&(console.warn("Cannot apply a component onto an element that already has a component. Applying to the base object instead..."),e=Object.assign(e,u));let d=le(c,e,c[l.path],t,!0);return w(d)}else n={[l.element]:n}}else{if(Array.isArray(n))return w(n.map(c=>he(c,e,t)));if(o!=="object")throw new Error(`Invalid configuration type: ${o}. Expected object or string.`)}t=C(t);let s;t.monitor instanceof ie?(s=t.monitor,t.keySeparator=s.options.keySeparator):(t.monitor||(t.monitor={}),t.monitor.keySeparator||(t.keySeparator||(t.keySeparator=j),t.monitor.keySeparator=t.keySeparator),t.monitor=new ie(t.monitor)),t.clone&&(n=C(n)),t.monitor.options.fallbacks=[l.hierarchy];let i=t,r,a=c=>{if(!c[l.parent])return c;{let u=c[l.start]();return w(u,ln)}};if(t.nested?.parent&&t.nested?.name)r=q(n,t.nested.name,e,t.nested.parent,void 0,i);else{let c=Symbol("root"),f={};r=q(n,c,e,void 0,void 0,i,{[c]:u=>{t.monitor.set(c,u,i.listeners)},onInstanceCreated:(u,d)=>{if(i.listen!==!1){let m=d[l.listeners.value]??{},y=f[u]=new et(m,u,{id:c,instance:d,monitor:i.monitor,options:i});if(d[l.listeners.value]=m,Object.defineProperty(d,l.flow,{value:y,enumerable:!1,writable:!1}),l.trigger in d){Array.isArray(d[l.trigger])||(d[l.trigger]=[]);let S=d[l.trigger];y.onStart(()=>d.default(...S)),delete d[l.trigger]}}},onInstanceReady:u=>{f[u].start()}})}return w(r,a)},at=he,yt=C,ln=w;var fn=n=>{let e=document.getElementById(n);e?e.scrollIntoView({}):console.error(`No component found for path: ${n}`)},pn=!1,Le=class{constructor(e){this.paths={};this.set=(e,t)=>{t===void 0?delete this.paths[e]:this.paths[e]=t};this.setRoot=e=>this.set("",e);this.get=(e=this.getPath())=>{let t=this.paths;return e.split(/\.|\//).forEach(o=>t=t[o]??t[""][o]),t};this.load=(e,t,o=!0)=>{let s=e===void 0?this.getPath():e,i=this.get(s);i&&t&&t.preventDefault();let r=!i&&(!this.loaded||this.loaded.path!=="")&&o;if(r&&(s="",i=this.get("")),i){let a=this.options.element.root,p=s?this.options.element.target:void 0;if(p){(!this.loaded||this.loaded.path!==""&&s!=="")&&this.load(""),typeof p=="string"?a=document.querySelector(p):a=p;let u=[...a.children];if(a)for(let d of u)d.remove()}else this.loaded&&this.loaded.ref.__element.remove();let c=yt(i),f=he(c,{__parent:a});return s===""&&(this.root&&this.root.__element.remove(),this.root=f),this.loaded={path:s,ref:f},p&&window.scrollTo(0,0),this.loaded}else fn(s);r&&this.navigate(void 0,void 0,!1)};this.navigate=(e=this.getPath(),t,o=!1)=>{let s=e.split(/\.|\//).join(this.options.spa?"/":".");history.pushState({},"escodeRouterURL",this.options.spa?`${window.location.origin}/${s}`:`${window.location.origin}#${s}`),this.load(s,t,o)};this.getPath=e=>(e===void 0&&(this.options.spa&&(e=window.location.pathname.slice(1)),e||(e=window.location.hash.slice(1))),e??"");e=Object.assign({},e),e.element||(e.element={root:document.body}),(typeof e.element!="object"||!("root"in e.element))&&(e.element={root:e.element}),this.options=e,window.addEventListener("beforeunload",t=>this.load(void 0,t)),window.addEventListener("popstate",t=>this.load(void 0,t)),window.addEventListener("DOMContentLoaded",t=>{pn=!0,(!this.loaded||this.loaded.path==="")&&this.load(void 0,t)})}},bt=Le;var de=new bt({spa:!0,element:{root:document.body,target:"#content"}});de.setRoot(ye);de.set("about",be);de.set("work",_e);de.load();
//# sourceMappingURL=index.esm.js.map
